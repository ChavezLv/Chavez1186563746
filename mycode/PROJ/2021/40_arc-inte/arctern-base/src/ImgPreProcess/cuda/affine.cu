//
// Created by Admin on 2021/11/1.
//

#include "affine.cuh"
#include <assert.h>
__constant__ float BilinearTab_f[1024][2][2] = {{{1,0},{0,0}},
{{0.96875,0.03125},{0,0}},
{{0.9375,0.0625},{0,0}},
{{0.90625,0.09375},{0,0}},
{{0.875,0.125},{0,0}},
{{0.84375,0.15625},{0,0}},
{{0.8125,0.1875},{0,0}},
{{0.78125,0.21875},{0,0}},
{{0.75,0.25},{0,0}},
{{0.71875,0.28125},{0,0}},
{{0.6875,0.3125},{0,0}},
{{0.65625,0.34375},{0,0}},
{{0.625,0.375},{0,0}},
{{0.59375,0.40625},{0,0}},
{{0.5625,0.4375},{0,0}},
{{0.53125,0.46875},{0,0}},
{{0.5,0.5},{0,0}},
{{0.46875,0.53125},{0,0}},
{{0.4375,0.5625},{0,0}},
{{0.40625,0.59375},{0,0}},
{{0.375,0.625},{0,0}},
{{0.34375,0.65625},{0,0}},
{{0.3125,0.6875},{0,0}},
{{0.28125,0.71875},{0,0}},
{{0.25,0.75},{0,0}},
{{0.21875,0.78125},{0,0}},
{{0.1875,0.8125},{0,0}},
{{0.15625,0.84375},{0,0}},
{{0.125,0.875},{0,0}},
{{0.09375,0.90625},{0,0}},
{{0.0625,0.9375},{0,0}},
{{0.03125,0.96875},{0,0}},
{{0.96875,0},{0.03125,0}},
{{0.938476562,0.0302734375},{0.0302734375,0.0009765625}},
{{0.908203125,0.060546875},{0.029296875,0.001953125}},
{{0.877929688,0.0908203125},{0.0283203125,0.0029296875}},
{{0.84765625,0.12109375},{0.02734375,0.00390625}},
{{0.817382812,0.151367188},{0.0263671875,0.0048828125}},
{{0.787109375,0.181640625},{0.025390625,0.005859375}},
{{0.756835938,0.211914062},{0.0244140625,0.0068359375}},
{{0.7265625,0.2421875},{0.0234375,0.0078125}},
{{0.696289062,0.272460938},{0.0224609375,0.0087890625}},
{{0.666015625,0.302734375},{0.021484375,0.009765625}},
{{0.635742188,0.333007812},{0.0205078125,0.0107421875}},
{{0.60546875,0.36328125},{0.01953125,0.01171875}},
{{0.575195312,0.393554688},{0.0185546875,0.0126953125}},
{{0.544921875,0.423828125},{0.017578125,0.013671875}},
{{0.514648438,0.454101562},{0.0166015625,0.0146484375}},
{{0.484375,0.484375},{0.015625,0.015625}},
{{0.454101562,0.514648438},{0.0146484375,0.0166015625}},
{{0.423828125,0.544921875},{0.013671875,0.017578125}},
{{0.393554688,0.575195312},{0.0126953125,0.0185546875}},
{{0.36328125,0.60546875},{0.01171875,0.01953125}},
{{0.333007812,0.635742188},{0.0107421875,0.0205078125}},
{{0.302734375,0.666015625},{0.009765625,0.021484375}},
{{0.272460938,0.696289062},{0.0087890625,0.0224609375}},
{{0.2421875,0.7265625},{0.0078125,0.0234375}},
{{0.211914062,0.756835938},{0.0068359375,0.0244140625}},
{{0.181640625,0.787109375},{0.005859375,0.025390625}},
{{0.151367188,0.817382812},{0.0048828125,0.0263671875}},
{{0.12109375,0.84765625},{0.00390625,0.02734375}},
{{0.0908203125,0.877929688},{0.0029296875,0.0283203125}},
{{0.060546875,0.908203125},{0.001953125,0.029296875}},
{{0.0302734375,0.938476562},{0.0009765625,0.0302734375}},
{{0.9375,0},{0.0625,0}},
{{0.908203125,0.029296875},{0.060546875,0.001953125}},
{{0.87890625,0.05859375},{0.05859375,0.00390625}},
{{0.849609375,0.087890625},{0.056640625,0.005859375}},
{{0.8203125,0.1171875},{0.0546875,0.0078125}},
{{0.791015625,0.146484375},{0.052734375,0.009765625}},
{{0.76171875,0.17578125},{0.05078125,0.01171875}},
{{0.732421875,0.205078125},{0.048828125,0.013671875}},
{{0.703125,0.234375},{0.046875,0.015625}},
{{0.673828125,0.263671875},{0.044921875,0.017578125}},
{{0.64453125,0.29296875},{0.04296875,0.01953125}},
{{0.615234375,0.322265625},{0.041015625,0.021484375}},
{{0.5859375,0.3515625},{0.0390625,0.0234375}},
{{0.556640625,0.380859375},{0.037109375,0.025390625}},
{{0.52734375,0.41015625},{0.03515625,0.02734375}},
{{0.498046875,0.439453125},{0.033203125,0.029296875}},
{{0.46875,0.46875},{0.03125,0.03125}},
{{0.439453125,0.498046875},{0.029296875,0.033203125}},
{{0.41015625,0.52734375},{0.02734375,0.03515625}},
{{0.380859375,0.556640625},{0.025390625,0.037109375}},
{{0.3515625,0.5859375},{0.0234375,0.0390625}},
{{0.322265625,0.615234375},{0.021484375,0.041015625}},
{{0.29296875,0.64453125},{0.01953125,0.04296875}},
{{0.263671875,0.673828125},{0.017578125,0.044921875}},
{{0.234375,0.703125},{0.015625,0.046875}},
{{0.205078125,0.732421875},{0.013671875,0.048828125}},
{{0.17578125,0.76171875},{0.01171875,0.05078125}},
{{0.146484375,0.791015625},{0.009765625,0.052734375}},
{{0.1171875,0.8203125},{0.0078125,0.0546875}},
{{0.087890625,0.849609375},{0.005859375,0.056640625}},
{{0.05859375,0.87890625},{0.00390625,0.05859375}},
{{0.029296875,0.908203125},{0.001953125,0.060546875}},
{{0.90625,0},{0.09375,0}},
{{0.877929688,0.0283203125},{0.0908203125,0.0029296875}},
{{0.849609375,0.056640625},{0.087890625,0.005859375}},
{{0.821289062,0.0849609375},{0.0849609375,0.0087890625}},
{{0.79296875,0.11328125},{0.08203125,0.01171875}},
{{0.764648438,0.141601562},{0.0791015625,0.0146484375}},
{{0.736328125,0.169921875},{0.076171875,0.017578125}},
{{0.708007812,0.198242188},{0.0732421875,0.0205078125}},
{{0.6796875,0.2265625},{0.0703125,0.0234375}},
{{0.651367188,0.254882812},{0.0673828125,0.0263671875}},
{{0.623046875,0.283203125},{0.064453125,0.029296875}},
{{0.594726562,0.311523438},{0.0615234375,0.0322265625}},
{{0.56640625,0.33984375},{0.05859375,0.03515625}},
{{0.538085938,0.368164062},{0.0556640625,0.0380859375}},
{{0.509765625,0.396484375},{0.052734375,0.041015625}},
{{0.481445312,0.424804688},{0.0498046875,0.0439453125}},
{{0.453125,0.453125},{0.046875,0.046875}},
{{0.424804688,0.481445312},{0.0439453125,0.0498046875}},
{{0.396484375,0.509765625},{0.041015625,0.052734375}},
{{0.368164062,0.538085938},{0.0380859375,0.0556640625}},
{{0.33984375,0.56640625},{0.03515625,0.05859375}},
{{0.311523438,0.594726562},{0.0322265625,0.0615234375}},
{{0.283203125,0.623046875},{0.029296875,0.064453125}},
{{0.254882812,0.651367188},{0.0263671875,0.0673828125}},
{{0.2265625,0.6796875},{0.0234375,0.0703125}},
{{0.198242188,0.708007812},{0.0205078125,0.0732421875}},
{{0.169921875,0.736328125},{0.017578125,0.076171875}},
{{0.141601562,0.764648438},{0.0146484375,0.0791015625}},
{{0.11328125,0.79296875},{0.01171875,0.08203125}},
{{0.0849609375,0.821289062},{0.0087890625,0.0849609375}},
{{0.056640625,0.849609375},{0.005859375,0.087890625}},
{{0.0283203125,0.877929688},{0.0029296875,0.0908203125}},
{{0.875,0},{0.125,0}},
{{0.84765625,0.02734375},{0.12109375,0.00390625}},
{{0.8203125,0.0546875},{0.1171875,0.0078125}},
{{0.79296875,0.08203125},{0.11328125,0.01171875}},
{{0.765625,0.109375},{0.109375,0.015625}},
{{0.73828125,0.13671875},{0.10546875,0.01953125}},
{{0.7109375,0.1640625},{0.1015625,0.0234375}},
{{0.68359375,0.19140625},{0.09765625,0.02734375}},
{{0.65625,0.21875},{0.09375,0.03125}},
{{0.62890625,0.24609375},{0.08984375,0.03515625}},
{{0.6015625,0.2734375},{0.0859375,0.0390625}},
{{0.57421875,0.30078125},{0.08203125,0.04296875}},
{{0.546875,0.328125},{0.078125,0.046875}},
{{0.51953125,0.35546875},{0.07421875,0.05078125}},
{{0.4921875,0.3828125},{0.0703125,0.0546875}},
{{0.46484375,0.41015625},{0.06640625,0.05859375}},
{{0.4375,0.4375},{0.0625,0.0625}},
{{0.41015625,0.46484375},{0.05859375,0.06640625}},
{{0.3828125,0.4921875},{0.0546875,0.0703125}},
{{0.35546875,0.51953125},{0.05078125,0.07421875}},
{{0.328125,0.546875},{0.046875,0.078125}},
{{0.30078125,0.57421875},{0.04296875,0.08203125}},
{{0.2734375,0.6015625},{0.0390625,0.0859375}},
{{0.24609375,0.62890625},{0.03515625,0.08984375}},
{{0.21875,0.65625},{0.03125,0.09375}},
{{0.19140625,0.68359375},{0.02734375,0.09765625}},
{{0.1640625,0.7109375},{0.0234375,0.1015625}},
{{0.13671875,0.73828125},{0.01953125,0.10546875}},
{{0.109375,0.765625},{0.015625,0.109375}},
{{0.08203125,0.79296875},{0.01171875,0.11328125}},
{{0.0546875,0.8203125},{0.0078125,0.1171875}},
{{0.02734375,0.84765625},{0.00390625,0.12109375}},
{{0.84375,0},{0.15625,0}},
{{0.817382812,0.0263671875},{0.151367188,0.0048828125}},
{{0.791015625,0.052734375},{0.146484375,0.009765625}},
{{0.764648438,0.0791015625},{0.141601562,0.0146484375}},
{{0.73828125,0.10546875},{0.13671875,0.01953125}},
{{0.711914062,0.131835938},{0.131835938,0.0244140625}},
{{0.685546875,0.158203125},{0.126953125,0.029296875}},
{{0.659179688,0.184570312},{0.122070312,0.0341796875}},
{{0.6328125,0.2109375},{0.1171875,0.0390625}},
{{0.606445312,0.237304688},{0.112304688,0.0439453125}},
{{0.580078125,0.263671875},{0.107421875,0.048828125}},
{{0.553710938,0.290039062},{0.102539062,0.0537109375}},
{{0.52734375,0.31640625},{0.09765625,0.05859375}},
{{0.500976562,0.342773438},{0.0927734375,0.0634765625}},
{{0.474609375,0.369140625},{0.087890625,0.068359375}},
{{0.448242188,0.395507812},{0.0830078125,0.0732421875}},
{{0.421875,0.421875},{0.078125,0.078125}},
{{0.395507812,0.448242188},{0.0732421875,0.0830078125}},
{{0.369140625,0.474609375},{0.068359375,0.087890625}},
{{0.342773438,0.500976562},{0.0634765625,0.0927734375}},
{{0.31640625,0.52734375},{0.05859375,0.09765625}},
{{0.290039062,0.553710938},{0.0537109375,0.102539062}},
{{0.263671875,0.580078125},{0.048828125,0.107421875}},
{{0.237304688,0.606445312},{0.0439453125,0.112304688}},
{{0.2109375,0.6328125},{0.0390625,0.1171875}},
{{0.184570312,0.659179688},{0.0341796875,0.122070312}},
{{0.158203125,0.685546875},{0.029296875,0.126953125}},
{{0.131835938,0.711914062},{0.0244140625,0.131835938}},
{{0.10546875,0.73828125},{0.01953125,0.13671875}},
{{0.0791015625,0.764648438},{0.0146484375,0.141601562}},
{{0.052734375,0.791015625},{0.009765625,0.146484375}},
{{0.0263671875,0.817382812},{0.0048828125,0.151367188}},
{{0.8125,0},{0.1875,0}},
{{0.787109375,0.025390625},{0.181640625,0.005859375}},
{{0.76171875,0.05078125},{0.17578125,0.01171875}},
{{0.736328125,0.076171875},{0.169921875,0.017578125}},
{{0.7109375,0.1015625},{0.1640625,0.0234375}},
{{0.685546875,0.126953125},{0.158203125,0.029296875}},
{{0.66015625,0.15234375},{0.15234375,0.03515625}},
{{0.634765625,0.177734375},{0.146484375,0.041015625}},
{{0.609375,0.203125},{0.140625,0.046875}},
{{0.583984375,0.228515625},{0.134765625,0.052734375}},
{{0.55859375,0.25390625},{0.12890625,0.05859375}},
{{0.533203125,0.279296875},{0.123046875,0.064453125}},
{{0.5078125,0.3046875},{0.1171875,0.0703125}},
{{0.482421875,0.330078125},{0.111328125,0.076171875}},
{{0.45703125,0.35546875},{0.10546875,0.08203125}},
{{0.431640625,0.380859375},{0.099609375,0.087890625}},
{{0.40625,0.40625},{0.09375,0.09375}},
{{0.380859375,0.431640625},{0.087890625,0.099609375}},
{{0.35546875,0.45703125},{0.08203125,0.10546875}},
{{0.330078125,0.482421875},{0.076171875,0.111328125}},
{{0.3046875,0.5078125},{0.0703125,0.1171875}},
{{0.279296875,0.533203125},{0.064453125,0.123046875}},
{{0.25390625,0.55859375},{0.05859375,0.12890625}},
{{0.228515625,0.583984375},{0.052734375,0.134765625}},
{{0.203125,0.609375},{0.046875,0.140625}},
{{0.177734375,0.634765625},{0.041015625,0.146484375}},
{{0.15234375,0.66015625},{0.03515625,0.15234375}},
{{0.126953125,0.685546875},{0.029296875,0.158203125}},
{{0.1015625,0.7109375},{0.0234375,0.1640625}},
{{0.076171875,0.736328125},{0.017578125,0.169921875}},
{{0.05078125,0.76171875},{0.01171875,0.17578125}},
{{0.025390625,0.787109375},{0.005859375,0.181640625}},
{{0.78125,0},{0.21875,0}},
{{0.756835938,0.0244140625},{0.211914062,0.0068359375}},
{{0.732421875,0.048828125},{0.205078125,0.013671875}},
{{0.708007812,0.0732421875},{0.198242188,0.0205078125}},
{{0.68359375,0.09765625},{0.19140625,0.02734375}},
{{0.659179688,0.122070312},{0.184570312,0.0341796875}},
{{0.634765625,0.146484375},{0.177734375,0.041015625}},
{{0.610351562,0.170898438},{0.170898438,0.0478515625}},
{{0.5859375,0.1953125},{0.1640625,0.0546875}},
{{0.561523438,0.219726562},{0.157226562,0.0615234375}},
{{0.537109375,0.244140625},{0.150390625,0.068359375}},
{{0.512695312,0.268554688},{0.143554688,0.0751953125}},
{{0.48828125,0.29296875},{0.13671875,0.08203125}},
{{0.463867188,0.317382812},{0.129882812,0.0888671875}},
{{0.439453125,0.341796875},{0.123046875,0.095703125}},
{{0.415039062,0.366210938},{0.116210938,0.102539062}},
{{0.390625,0.390625},{0.109375,0.109375}},
{{0.366210938,0.415039062},{0.102539062,0.116210938}},
{{0.341796875,0.439453125},{0.095703125,0.123046875}},
{{0.317382812,0.463867188},{0.0888671875,0.129882812}},
{{0.29296875,0.48828125},{0.08203125,0.13671875}},
{{0.268554688,0.512695312},{0.0751953125,0.143554688}},
{{0.244140625,0.537109375},{0.068359375,0.150390625}},
{{0.219726562,0.561523438},{0.0615234375,0.157226562}},
{{0.1953125,0.5859375},{0.0546875,0.1640625}},
{{0.170898438,0.610351562},{0.0478515625,0.170898438}},
{{0.146484375,0.634765625},{0.041015625,0.177734375}},
{{0.122070312,0.659179688},{0.0341796875,0.184570312}},
{{0.09765625,0.68359375},{0.02734375,0.19140625}},
{{0.0732421875,0.708007812},{0.0205078125,0.198242188}},
{{0.048828125,0.732421875},{0.013671875,0.205078125}},
{{0.0244140625,0.756835938},{0.0068359375,0.211914062}},
{{0.75,0},{0.25,0}},
{{0.7265625,0.0234375},{0.2421875,0.0078125}},
{{0.703125,0.046875},{0.234375,0.015625}},
{{0.6796875,0.0703125},{0.2265625,0.0234375}},
{{0.65625,0.09375},{0.21875,0.03125}},
{{0.6328125,0.1171875},{0.2109375,0.0390625}},
{{0.609375,0.140625},{0.203125,0.046875}},
{{0.5859375,0.1640625},{0.1953125,0.0546875}},
{{0.5625,0.1875},{0.1875,0.0625}},
{{0.5390625,0.2109375},{0.1796875,0.0703125}},
{{0.515625,0.234375},{0.171875,0.078125}},
{{0.4921875,0.2578125},{0.1640625,0.0859375}},
{{0.46875,0.28125},{0.15625,0.09375}},
{{0.4453125,0.3046875},{0.1484375,0.1015625}},
{{0.421875,0.328125},{0.140625,0.109375}},
{{0.3984375,0.3515625},{0.1328125,0.1171875}},
{{0.375,0.375},{0.125,0.125}},
{{0.3515625,0.3984375},{0.1171875,0.1328125}},
{{0.328125,0.421875},{0.109375,0.140625}},
{{0.3046875,0.4453125},{0.1015625,0.1484375}},
{{0.28125,0.46875},{0.09375,0.15625}},
{{0.2578125,0.4921875},{0.0859375,0.1640625}},
{{0.234375,0.515625},{0.078125,0.171875}},
{{0.2109375,0.5390625},{0.0703125,0.1796875}},
{{0.1875,0.5625},{0.0625,0.1875}},
{{0.1640625,0.5859375},{0.0546875,0.1953125}},
{{0.140625,0.609375},{0.046875,0.203125}},
{{0.1171875,0.6328125},{0.0390625,0.2109375}},
{{0.09375,0.65625},{0.03125,0.21875}},
{{0.0703125,0.6796875},{0.0234375,0.2265625}},
{{0.046875,0.703125},{0.015625,0.234375}},
{{0.0234375,0.7265625},{0.0078125,0.2421875}},
{{0.71875,0},{0.28125,0}},
{{0.696289062,0.0224609375},{0.272460938,0.0087890625}},
{{0.673828125,0.044921875},{0.263671875,0.017578125}},
{{0.651367188,0.0673828125},{0.254882812,0.0263671875}},
{{0.62890625,0.08984375},{0.24609375,0.03515625}},
{{0.606445312,0.112304688},{0.237304688,0.0439453125}},
{{0.583984375,0.134765625},{0.228515625,0.052734375}},
{{0.561523438,0.157226562},{0.219726562,0.0615234375}},
{{0.5390625,0.1796875},{0.2109375,0.0703125}},
{{0.516601562,0.202148438},{0.202148438,0.0791015625}},
{{0.494140625,0.224609375},{0.193359375,0.087890625}},
{{0.471679688,0.247070312},{0.184570312,0.0966796875}},
{{0.44921875,0.26953125},{0.17578125,0.10546875}},
{{0.426757812,0.291992188},{0.166992188,0.114257812}},
{{0.404296875,0.314453125},{0.158203125,0.123046875}},
{{0.381835938,0.336914062},{0.149414062,0.131835938}},
{{0.359375,0.359375},{0.140625,0.140625}},
{{0.336914062,0.381835938},{0.131835938,0.149414062}},
{{0.314453125,0.404296875},{0.123046875,0.158203125}},
{{0.291992188,0.426757812},{0.114257812,0.166992188}},
{{0.26953125,0.44921875},{0.10546875,0.17578125}},
{{0.247070312,0.471679688},{0.0966796875,0.184570312}},
{{0.224609375,0.494140625},{0.087890625,0.193359375}},
{{0.202148438,0.516601562},{0.0791015625,0.202148438}},
{{0.1796875,0.5390625},{0.0703125,0.2109375}},
{{0.157226562,0.561523438},{0.0615234375,0.219726562}},
{{0.134765625,0.583984375},{0.052734375,0.228515625}},
{{0.112304688,0.606445312},{0.0439453125,0.237304688}},
{{0.08984375,0.62890625},{0.03515625,0.24609375}},
{{0.0673828125,0.651367188},{0.0263671875,0.254882812}},
{{0.044921875,0.673828125},{0.017578125,0.263671875}},
{{0.0224609375,0.696289062},{0.0087890625,0.272460938}},
{{0.6875,0},{0.3125,0}},
{{0.666015625,0.021484375},{0.302734375,0.009765625}},
{{0.64453125,0.04296875},{0.29296875,0.01953125}},
{{0.623046875,0.064453125},{0.283203125,0.029296875}},
{{0.6015625,0.0859375},{0.2734375,0.0390625}},
{{0.580078125,0.107421875},{0.263671875,0.048828125}},
{{0.55859375,0.12890625},{0.25390625,0.05859375}},
{{0.537109375,0.150390625},{0.244140625,0.068359375}},
{{0.515625,0.171875},{0.234375,0.078125}},
{{0.494140625,0.193359375},{0.224609375,0.087890625}},
{{0.47265625,0.21484375},{0.21484375,0.09765625}},
{{0.451171875,0.236328125},{0.205078125,0.107421875}},
{{0.4296875,0.2578125},{0.1953125,0.1171875}},
{{0.408203125,0.279296875},{0.185546875,0.126953125}},
{{0.38671875,0.30078125},{0.17578125,0.13671875}},
{{0.365234375,0.322265625},{0.166015625,0.146484375}},
{{0.34375,0.34375},{0.15625,0.15625}},
{{0.322265625,0.365234375},{0.146484375,0.166015625}},
{{0.30078125,0.38671875},{0.13671875,0.17578125}},
{{0.279296875,0.408203125},{0.126953125,0.185546875}},
{{0.2578125,0.4296875},{0.1171875,0.1953125}},
{{0.236328125,0.451171875},{0.107421875,0.205078125}},
{{0.21484375,0.47265625},{0.09765625,0.21484375}},
{{0.193359375,0.494140625},{0.087890625,0.224609375}},
{{0.171875,0.515625},{0.078125,0.234375}},
{{0.150390625,0.537109375},{0.068359375,0.244140625}},
{{0.12890625,0.55859375},{0.05859375,0.25390625}},
{{0.107421875,0.580078125},{0.048828125,0.263671875}},
{{0.0859375,0.6015625},{0.0390625,0.2734375}},
{{0.064453125,0.623046875},{0.029296875,0.283203125}},
{{0.04296875,0.64453125},{0.01953125,0.29296875}},
{{0.021484375,0.666015625},{0.009765625,0.302734375}},
{{0.65625,0},{0.34375,0}},
{{0.635742188,0.0205078125},{0.333007812,0.0107421875}},
{{0.615234375,0.041015625},{0.322265625,0.021484375}},
{{0.594726562,0.0615234375},{0.311523438,0.0322265625}},
{{0.57421875,0.08203125},{0.30078125,0.04296875}},
{{0.553710938,0.102539062},{0.290039062,0.0537109375}},
{{0.533203125,0.123046875},{0.279296875,0.064453125}},
{{0.512695312,0.143554688},{0.268554688,0.0751953125}},
{{0.4921875,0.1640625},{0.2578125,0.0859375}},
{{0.471679688,0.184570312},{0.247070312,0.0966796875}},
{{0.451171875,0.205078125},{0.236328125,0.107421875}},
{{0.430664062,0.225585938},{0.225585938,0.118164062}},
{{0.41015625,0.24609375},{0.21484375,0.12890625}},
{{0.389648438,0.266601562},{0.204101562,0.139648438}},
{{0.369140625,0.287109375},{0.193359375,0.150390625}},
{{0.348632812,0.307617188},{0.182617188,0.161132812}},
{{0.328125,0.328125},{0.171875,0.171875}},
{{0.307617188,0.348632812},{0.161132812,0.182617188}},
{{0.287109375,0.369140625},{0.150390625,0.193359375}},
{{0.266601562,0.389648438},{0.139648438,0.204101562}},
{{0.24609375,0.41015625},{0.12890625,0.21484375}},
{{0.225585938,0.430664062},{0.118164062,0.225585938}},
{{0.205078125,0.451171875},{0.107421875,0.236328125}},
{{0.184570312,0.471679688},{0.0966796875,0.247070312}},
{{0.1640625,0.4921875},{0.0859375,0.2578125}},
{{0.143554688,0.512695312},{0.0751953125,0.268554688}},
{{0.123046875,0.533203125},{0.064453125,0.279296875}},
{{0.102539062,0.553710938},{0.0537109375,0.290039062}},
{{0.08203125,0.57421875},{0.04296875,0.30078125}},
{{0.0615234375,0.594726562},{0.0322265625,0.311523438}},
{{0.041015625,0.615234375},{0.021484375,0.322265625}},
{{0.0205078125,0.635742188},{0.0107421875,0.333007812}},
{{0.625,0},{0.375,0}},
{{0.60546875,0.01953125},{0.36328125,0.01171875}},
{{0.5859375,0.0390625},{0.3515625,0.0234375}},
{{0.56640625,0.05859375},{0.33984375,0.03515625}},
{{0.546875,0.078125},{0.328125,0.046875}},
{{0.52734375,0.09765625},{0.31640625,0.05859375}},
{{0.5078125,0.1171875},{0.3046875,0.0703125}},
{{0.48828125,0.13671875},{0.29296875,0.08203125}},
{{0.46875,0.15625},{0.28125,0.09375}},
{{0.44921875,0.17578125},{0.26953125,0.10546875}},
{{0.4296875,0.1953125},{0.2578125,0.1171875}},
{{0.41015625,0.21484375},{0.24609375,0.12890625}},
{{0.390625,0.234375},{0.234375,0.140625}},
{{0.37109375,0.25390625},{0.22265625,0.15234375}},
{{0.3515625,0.2734375},{0.2109375,0.1640625}},
{{0.33203125,0.29296875},{0.19921875,0.17578125}},
{{0.3125,0.3125},{0.1875,0.1875}},
{{0.29296875,0.33203125},{0.17578125,0.19921875}},
{{0.2734375,0.3515625},{0.1640625,0.2109375}},
{{0.25390625,0.37109375},{0.15234375,0.22265625}},
{{0.234375,0.390625},{0.140625,0.234375}},
{{0.21484375,0.41015625},{0.12890625,0.24609375}},
{{0.1953125,0.4296875},{0.1171875,0.2578125}},
{{0.17578125,0.44921875},{0.10546875,0.26953125}},
{{0.15625,0.46875},{0.09375,0.28125}},
{{0.13671875,0.48828125},{0.08203125,0.29296875}},
{{0.1171875,0.5078125},{0.0703125,0.3046875}},
{{0.09765625,0.52734375},{0.05859375,0.31640625}},
{{0.078125,0.546875},{0.046875,0.328125}},
{{0.05859375,0.56640625},{0.03515625,0.33984375}},
{{0.0390625,0.5859375},{0.0234375,0.3515625}},
{{0.01953125,0.60546875},{0.01171875,0.36328125}},
{{0.59375,0},{0.40625,0}},
{{0.575195312,0.0185546875},{0.393554688,0.0126953125}},
{{0.556640625,0.037109375},{0.380859375,0.025390625}},
{{0.538085938,0.0556640625},{0.368164062,0.0380859375}},
{{0.51953125,0.07421875},{0.35546875,0.05078125}},
{{0.500976562,0.0927734375},{0.342773438,0.0634765625}},
{{0.482421875,0.111328125},{0.330078125,0.076171875}},
{{0.463867188,0.129882812},{0.317382812,0.0888671875}},
{{0.4453125,0.1484375},{0.3046875,0.1015625}},
{{0.426757812,0.166992188},{0.291992188,0.114257812}},
{{0.408203125,0.185546875},{0.279296875,0.126953125}},
{{0.389648438,0.204101562},{0.266601562,0.139648438}},
{{0.37109375,0.22265625},{0.25390625,0.15234375}},
{{0.352539062,0.241210938},{0.241210938,0.165039062}},
{{0.333984375,0.259765625},{0.228515625,0.177734375}},
{{0.315429688,0.278320312},{0.215820312,0.190429688}},
{{0.296875,0.296875},{0.203125,0.203125}},
{{0.278320312,0.315429688},{0.190429688,0.215820312}},
{{0.259765625,0.333984375},{0.177734375,0.228515625}},
{{0.241210938,0.352539062},{0.165039062,0.241210938}},
{{0.22265625,0.37109375},{0.15234375,0.25390625}},
{{0.204101562,0.389648438},{0.139648438,0.266601562}},
{{0.185546875,0.408203125},{0.126953125,0.279296875}},
{{0.166992188,0.426757812},{0.114257812,0.291992188}},
{{0.1484375,0.4453125},{0.1015625,0.3046875}},
{{0.129882812,0.463867188},{0.0888671875,0.317382812}},
{{0.111328125,0.482421875},{0.076171875,0.330078125}},
{{0.0927734375,0.500976562},{0.0634765625,0.342773438}},
{{0.07421875,0.51953125},{0.05078125,0.35546875}},
{{0.0556640625,0.538085938},{0.0380859375,0.368164062}},
{{0.037109375,0.556640625},{0.025390625,0.380859375}},
{{0.0185546875,0.575195312},{0.0126953125,0.393554688}},
{{0.5625,0},{0.4375,0}},
{{0.544921875,0.017578125},{0.423828125,0.013671875}},
{{0.52734375,0.03515625},{0.41015625,0.02734375}},
{{0.509765625,0.052734375},{0.396484375,0.041015625}},
{{0.4921875,0.0703125},{0.3828125,0.0546875}},
{{0.474609375,0.087890625},{0.369140625,0.068359375}},
{{0.45703125,0.10546875},{0.35546875,0.08203125}},
{{0.439453125,0.123046875},{0.341796875,0.095703125}},
{{0.421875,0.140625},{0.328125,0.109375}},
{{0.404296875,0.158203125},{0.314453125,0.123046875}},
{{0.38671875,0.17578125},{0.30078125,0.13671875}},
{{0.369140625,0.193359375},{0.287109375,0.150390625}},
{{0.3515625,0.2109375},{0.2734375,0.1640625}},
{{0.333984375,0.228515625},{0.259765625,0.177734375}},
{{0.31640625,0.24609375},{0.24609375,0.19140625}},
{{0.298828125,0.263671875},{0.232421875,0.205078125}},
{{0.28125,0.28125},{0.21875,0.21875}},
{{0.263671875,0.298828125},{0.205078125,0.232421875}},
{{0.24609375,0.31640625},{0.19140625,0.24609375}},
{{0.228515625,0.333984375},{0.177734375,0.259765625}},
{{0.2109375,0.3515625},{0.1640625,0.2734375}},
{{0.193359375,0.369140625},{0.150390625,0.287109375}},
{{0.17578125,0.38671875},{0.13671875,0.30078125}},
{{0.158203125,0.404296875},{0.123046875,0.314453125}},
{{0.140625,0.421875},{0.109375,0.328125}},
{{0.123046875,0.439453125},{0.095703125,0.341796875}},
{{0.10546875,0.45703125},{0.08203125,0.35546875}},
{{0.087890625,0.474609375},{0.068359375,0.369140625}},
{{0.0703125,0.4921875},{0.0546875,0.3828125}},
{{0.052734375,0.509765625},{0.041015625,0.396484375}},
{{0.03515625,0.52734375},{0.02734375,0.41015625}},
{{0.017578125,0.544921875},{0.013671875,0.423828125}},
{{0.53125,0},{0.46875,0}},
{{0.514648438,0.0166015625},{0.454101562,0.0146484375}},
{{0.498046875,0.033203125},{0.439453125,0.029296875}},
{{0.481445312,0.0498046875},{0.424804688,0.0439453125}},
{{0.46484375,0.06640625},{0.41015625,0.05859375}},
{{0.448242188,0.0830078125},{0.395507812,0.0732421875}},
{{0.431640625,0.099609375},{0.380859375,0.087890625}},
{{0.415039062,0.116210938},{0.366210938,0.102539062}},
{{0.3984375,0.1328125},{0.3515625,0.1171875}},
{{0.381835938,0.149414062},{0.336914062,0.131835938}},
{{0.365234375,0.166015625},{0.322265625,0.146484375}},
{{0.348632812,0.182617188},{0.307617188,0.161132812}},
{{0.33203125,0.19921875},{0.29296875,0.17578125}},
{{0.315429688,0.215820312},{0.278320312,0.190429688}},
{{0.298828125,0.232421875},{0.263671875,0.205078125}},
{{0.282226562,0.249023438},{0.249023438,0.219726562}},
{{0.265625,0.265625},{0.234375,0.234375}},
{{0.249023438,0.282226562},{0.219726562,0.249023438}},
{{0.232421875,0.298828125},{0.205078125,0.263671875}},
{{0.215820312,0.315429688},{0.190429688,0.278320312}},
{{0.19921875,0.33203125},{0.17578125,0.29296875}},
{{0.182617188,0.348632812},{0.161132812,0.307617188}},
{{0.166015625,0.365234375},{0.146484375,0.322265625}},
{{0.149414062,0.381835938},{0.131835938,0.336914062}},
{{0.1328125,0.3984375},{0.1171875,0.3515625}},
{{0.116210938,0.415039062},{0.102539062,0.366210938}},
{{0.099609375,0.431640625},{0.087890625,0.380859375}},
{{0.0830078125,0.448242188},{0.0732421875,0.395507812}},
{{0.06640625,0.46484375},{0.05859375,0.41015625}},
{{0.0498046875,0.481445312},{0.0439453125,0.424804688}},
{{0.033203125,0.498046875},{0.029296875,0.439453125}},
{{0.0166015625,0.514648438},{0.0146484375,0.454101562}},
{{0.5,0},{0.5,0}},
{{0.484375,0.015625},{0.484375,0.015625}},
{{0.46875,0.03125},{0.46875,0.03125}},
{{0.453125,0.046875},{0.453125,0.046875}},
{{0.4375,0.0625},{0.4375,0.0625}},
{{0.421875,0.078125},{0.421875,0.078125}},
{{0.40625,0.09375},{0.40625,0.09375}},
{{0.390625,0.109375},{0.390625,0.109375}},
{{0.375,0.125},{0.375,0.125}},
{{0.359375,0.140625},{0.359375,0.140625}},
{{0.34375,0.15625},{0.34375,0.15625}},
{{0.328125,0.171875},{0.328125,0.171875}},
{{0.3125,0.1875},{0.3125,0.1875}},
{{0.296875,0.203125},{0.296875,0.203125}},
{{0.28125,0.21875},{0.28125,0.21875}},
{{0.265625,0.234375},{0.265625,0.234375}},
{{0.25,0.25},{0.25,0.25}},
{{0.234375,0.265625},{0.234375,0.265625}},
{{0.21875,0.28125},{0.21875,0.28125}},
{{0.203125,0.296875},{0.203125,0.296875}},
{{0.1875,0.3125},{0.1875,0.3125}},
{{0.171875,0.328125},{0.171875,0.328125}},
{{0.15625,0.34375},{0.15625,0.34375}},
{{0.140625,0.359375},{0.140625,0.359375}},
{{0.125,0.375},{0.125,0.375}},
{{0.109375,0.390625},{0.109375,0.390625}},
{{0.09375,0.40625},{0.09375,0.40625}},
{{0.078125,0.421875},{0.078125,0.421875}},
{{0.0625,0.4375},{0.0625,0.4375}},
{{0.046875,0.453125},{0.046875,0.453125}},
{{0.03125,0.46875},{0.03125,0.46875}},
{{0.015625,0.484375},{0.015625,0.484375}},
{{0.46875,0},{0.53125,0}},
{{0.454101562,0.0146484375},{0.514648438,0.0166015625}},
{{0.439453125,0.029296875},{0.498046875,0.033203125}},
{{0.424804688,0.0439453125},{0.481445312,0.0498046875}},
{{0.41015625,0.05859375},{0.46484375,0.06640625}},
{{0.395507812,0.0732421875},{0.448242188,0.0830078125}},
{{0.380859375,0.087890625},{0.431640625,0.099609375}},
{{0.366210938,0.102539062},{0.415039062,0.116210938}},
{{0.3515625,0.1171875},{0.3984375,0.1328125}},
{{0.336914062,0.131835938},{0.381835938,0.149414062}},
{{0.322265625,0.146484375},{0.365234375,0.166015625}},
{{0.307617188,0.161132812},{0.348632812,0.182617188}},
{{0.29296875,0.17578125},{0.33203125,0.19921875}},
{{0.278320312,0.190429688},{0.315429688,0.215820312}},
{{0.263671875,0.205078125},{0.298828125,0.232421875}},
{{0.249023438,0.219726562},{0.282226562,0.249023438}},
{{0.234375,0.234375},{0.265625,0.265625}},
{{0.219726562,0.249023438},{0.249023438,0.282226562}},
{{0.205078125,0.263671875},{0.232421875,0.298828125}},
{{0.190429688,0.278320312},{0.215820312,0.315429688}},
{{0.17578125,0.29296875},{0.19921875,0.33203125}},
{{0.161132812,0.307617188},{0.182617188,0.348632812}},
{{0.146484375,0.322265625},{0.166015625,0.365234375}},
{{0.131835938,0.336914062},{0.149414062,0.381835938}},
{{0.1171875,0.3515625},{0.1328125,0.3984375}},
{{0.102539062,0.366210938},{0.116210938,0.415039062}},
{{0.087890625,0.380859375},{0.099609375,0.431640625}},
{{0.0732421875,0.395507812},{0.0830078125,0.448242188}},
{{0.05859375,0.41015625},{0.06640625,0.46484375}},
{{0.0439453125,0.424804688},{0.0498046875,0.481445312}},
{{0.029296875,0.439453125},{0.033203125,0.498046875}},
{{0.0146484375,0.454101562},{0.0166015625,0.514648438}},
{{0.4375,0},{0.5625,0}},
{{0.423828125,0.013671875},{0.544921875,0.017578125}},
{{0.41015625,0.02734375},{0.52734375,0.03515625}},
{{0.396484375,0.041015625},{0.509765625,0.052734375}},
{{0.3828125,0.0546875},{0.4921875,0.0703125}},
{{0.369140625,0.068359375},{0.474609375,0.087890625}},
{{0.35546875,0.08203125},{0.45703125,0.10546875}},
{{0.341796875,0.095703125},{0.439453125,0.123046875}},
{{0.328125,0.109375},{0.421875,0.140625}},
{{0.314453125,0.123046875},{0.404296875,0.158203125}},
{{0.30078125,0.13671875},{0.38671875,0.17578125}},
{{0.287109375,0.150390625},{0.369140625,0.193359375}},
{{0.2734375,0.1640625},{0.3515625,0.2109375}},
{{0.259765625,0.177734375},{0.333984375,0.228515625}},
{{0.24609375,0.19140625},{0.31640625,0.24609375}},
{{0.232421875,0.205078125},{0.298828125,0.263671875}},
{{0.21875,0.21875},{0.28125,0.28125}},
{{0.205078125,0.232421875},{0.263671875,0.298828125}},
{{0.19140625,0.24609375},{0.24609375,0.31640625}},
{{0.177734375,0.259765625},{0.228515625,0.333984375}},
{{0.1640625,0.2734375},{0.2109375,0.3515625}},
{{0.150390625,0.287109375},{0.193359375,0.369140625}},
{{0.13671875,0.30078125},{0.17578125,0.38671875}},
{{0.123046875,0.314453125},{0.158203125,0.404296875}},
{{0.109375,0.328125},{0.140625,0.421875}},
{{0.095703125,0.341796875},{0.123046875,0.439453125}},
{{0.08203125,0.35546875},{0.10546875,0.45703125}},
{{0.068359375,0.369140625},{0.087890625,0.474609375}},
{{0.0546875,0.3828125},{0.0703125,0.4921875}},
{{0.041015625,0.396484375},{0.052734375,0.509765625}},
{{0.02734375,0.41015625},{0.03515625,0.52734375}},
{{0.013671875,0.423828125},{0.017578125,0.544921875}},
{{0.40625,0},{0.59375,0}},
{{0.393554688,0.0126953125},{0.575195312,0.0185546875}},
{{0.380859375,0.025390625},{0.556640625,0.037109375}},
{{0.368164062,0.0380859375},{0.538085938,0.0556640625}},
{{0.35546875,0.05078125},{0.51953125,0.07421875}},
{{0.342773438,0.0634765625},{0.500976562,0.0927734375}},
{{0.330078125,0.076171875},{0.482421875,0.111328125}},
{{0.317382812,0.0888671875},{0.463867188,0.129882812}},
{{0.3046875,0.1015625},{0.4453125,0.1484375}},
{{0.291992188,0.114257812},{0.426757812,0.166992188}},
{{0.279296875,0.126953125},{0.408203125,0.185546875}},
{{0.266601562,0.139648438},{0.389648438,0.204101562}},
{{0.25390625,0.15234375},{0.37109375,0.22265625}},
{{0.241210938,0.165039062},{0.352539062,0.241210938}},
{{0.228515625,0.177734375},{0.333984375,0.259765625}},
{{0.215820312,0.190429688},{0.315429688,0.278320312}},
{{0.203125,0.203125},{0.296875,0.296875}},
{{0.190429688,0.215820312},{0.278320312,0.315429688}},
{{0.177734375,0.228515625},{0.259765625,0.333984375}},
{{0.165039062,0.241210938},{0.241210938,0.352539062}},
{{0.15234375,0.25390625},{0.22265625,0.37109375}},
{{0.139648438,0.266601562},{0.204101562,0.389648438}},
{{0.126953125,0.279296875},{0.185546875,0.408203125}},
{{0.114257812,0.291992188},{0.166992188,0.426757812}},
{{0.1015625,0.3046875},{0.1484375,0.4453125}},
{{0.0888671875,0.317382812},{0.129882812,0.463867188}},
{{0.076171875,0.330078125},{0.111328125,0.482421875}},
{{0.0634765625,0.342773438},{0.0927734375,0.500976562}},
{{0.05078125,0.35546875},{0.07421875,0.51953125}},
{{0.0380859375,0.368164062},{0.0556640625,0.538085938}},
{{0.025390625,0.380859375},{0.037109375,0.556640625}},
{{0.0126953125,0.393554688},{0.0185546875,0.575195312}},
{{0.375,0},{0.625,0}},
{{0.36328125,0.01171875},{0.60546875,0.01953125}},
{{0.3515625,0.0234375},{0.5859375,0.0390625}},
{{0.33984375,0.03515625},{0.56640625,0.05859375}},
{{0.328125,0.046875},{0.546875,0.078125}},
{{0.31640625,0.05859375},{0.52734375,0.09765625}},
{{0.3046875,0.0703125},{0.5078125,0.1171875}},
{{0.29296875,0.08203125},{0.48828125,0.13671875}},
{{0.28125,0.09375},{0.46875,0.15625}},
{{0.26953125,0.10546875},{0.44921875,0.17578125}},
{{0.2578125,0.1171875},{0.4296875,0.1953125}},
{{0.24609375,0.12890625},{0.41015625,0.21484375}},
{{0.234375,0.140625},{0.390625,0.234375}},
{{0.22265625,0.15234375},{0.37109375,0.25390625}},
{{0.2109375,0.1640625},{0.3515625,0.2734375}},
{{0.19921875,0.17578125},{0.33203125,0.29296875}},
{{0.1875,0.1875},{0.3125,0.3125}},
{{0.17578125,0.19921875},{0.29296875,0.33203125}},
{{0.1640625,0.2109375},{0.2734375,0.3515625}},
{{0.15234375,0.22265625},{0.25390625,0.37109375}},
{{0.140625,0.234375},{0.234375,0.390625}},
{{0.12890625,0.24609375},{0.21484375,0.41015625}},
{{0.1171875,0.2578125},{0.1953125,0.4296875}},
{{0.10546875,0.26953125},{0.17578125,0.44921875}},
{{0.09375,0.28125},{0.15625,0.46875}},
{{0.08203125,0.29296875},{0.13671875,0.48828125}},
{{0.0703125,0.3046875},{0.1171875,0.5078125}},
{{0.05859375,0.31640625},{0.09765625,0.52734375}},
{{0.046875,0.328125},{0.078125,0.546875}},
{{0.03515625,0.33984375},{0.05859375,0.56640625}},
{{0.0234375,0.3515625},{0.0390625,0.5859375}},
{{0.01171875,0.36328125},{0.01953125,0.60546875}},
{{0.34375,0},{0.65625,0}},
{{0.333007812,0.0107421875},{0.635742188,0.0205078125}},
{{0.322265625,0.021484375},{0.615234375,0.041015625}},
{{0.311523438,0.0322265625},{0.594726562,0.0615234375}},
{{0.30078125,0.04296875},{0.57421875,0.08203125}},
{{0.290039062,0.0537109375},{0.553710938,0.102539062}},
{{0.279296875,0.064453125},{0.533203125,0.123046875}},
{{0.268554688,0.0751953125},{0.512695312,0.143554688}},
{{0.2578125,0.0859375},{0.4921875,0.1640625}},
{{0.247070312,0.0966796875},{0.471679688,0.184570312}},
{{0.236328125,0.107421875},{0.451171875,0.205078125}},
{{0.225585938,0.118164062},{0.430664062,0.225585938}},
{{0.21484375,0.12890625},{0.41015625,0.24609375}},
{{0.204101562,0.139648438},{0.389648438,0.266601562}},
{{0.193359375,0.150390625},{0.369140625,0.287109375}},
{{0.182617188,0.161132812},{0.348632812,0.307617188}},
{{0.171875,0.171875},{0.328125,0.328125}},
{{0.161132812,0.182617188},{0.307617188,0.348632812}},
{{0.150390625,0.193359375},{0.287109375,0.369140625}},
{{0.139648438,0.204101562},{0.266601562,0.389648438}},
{{0.12890625,0.21484375},{0.24609375,0.41015625}},
{{0.118164062,0.225585938},{0.225585938,0.430664062}},
{{0.107421875,0.236328125},{0.205078125,0.451171875}},
{{0.0966796875,0.247070312},{0.184570312,0.471679688}},
{{0.0859375,0.2578125},{0.1640625,0.4921875}},
{{0.0751953125,0.268554688},{0.143554688,0.512695312}},
{{0.064453125,0.279296875},{0.123046875,0.533203125}},
{{0.0537109375,0.290039062},{0.102539062,0.553710938}},
{{0.04296875,0.30078125},{0.08203125,0.57421875}},
{{0.0322265625,0.311523438},{0.0615234375,0.594726562}},
{{0.021484375,0.322265625},{0.041015625,0.615234375}},
{{0.0107421875,0.333007812},{0.0205078125,0.635742188}},
{{0.3125,0},{0.6875,0}},
{{0.302734375,0.009765625},{0.666015625,0.021484375}},
{{0.29296875,0.01953125},{0.64453125,0.04296875}},
{{0.283203125,0.029296875},{0.623046875,0.064453125}},
{{0.2734375,0.0390625},{0.6015625,0.0859375}},
{{0.263671875,0.048828125},{0.580078125,0.107421875}},
{{0.25390625,0.05859375},{0.55859375,0.12890625}},
{{0.244140625,0.068359375},{0.537109375,0.150390625}},
{{0.234375,0.078125},{0.515625,0.171875}},
{{0.224609375,0.087890625},{0.494140625,0.193359375}},
{{0.21484375,0.09765625},{0.47265625,0.21484375}},
{{0.205078125,0.107421875},{0.451171875,0.236328125}},
{{0.1953125,0.1171875},{0.4296875,0.2578125}},
{{0.185546875,0.126953125},{0.408203125,0.279296875}},
{{0.17578125,0.13671875},{0.38671875,0.30078125}},
{{0.166015625,0.146484375},{0.365234375,0.322265625}},
{{0.15625,0.15625},{0.34375,0.34375}},
{{0.146484375,0.166015625},{0.322265625,0.365234375}},
{{0.13671875,0.17578125},{0.30078125,0.38671875}},
{{0.126953125,0.185546875},{0.279296875,0.408203125}},
{{0.1171875,0.1953125},{0.2578125,0.4296875}},
{{0.107421875,0.205078125},{0.236328125,0.451171875}},
{{0.09765625,0.21484375},{0.21484375,0.47265625}},
{{0.087890625,0.224609375},{0.193359375,0.494140625}},
{{0.078125,0.234375},{0.171875,0.515625}},
{{0.068359375,0.244140625},{0.150390625,0.537109375}},
{{0.05859375,0.25390625},{0.12890625,0.55859375}},
{{0.048828125,0.263671875},{0.107421875,0.580078125}},
{{0.0390625,0.2734375},{0.0859375,0.6015625}},
{{0.029296875,0.283203125},{0.064453125,0.623046875}},
{{0.01953125,0.29296875},{0.04296875,0.64453125}},
{{0.009765625,0.302734375},{0.021484375,0.666015625}},
{{0.28125,0},{0.71875,0}},
{{0.272460938,0.0087890625},{0.696289062,0.0224609375}},
{{0.263671875,0.017578125},{0.673828125,0.044921875}},
{{0.254882812,0.0263671875},{0.651367188,0.0673828125}},
{{0.24609375,0.03515625},{0.62890625,0.08984375}},
{{0.237304688,0.0439453125},{0.606445312,0.112304688}},
{{0.228515625,0.052734375},{0.583984375,0.134765625}},
{{0.219726562,0.0615234375},{0.561523438,0.157226562}},
{{0.2109375,0.0703125},{0.5390625,0.1796875}},
{{0.202148438,0.0791015625},{0.516601562,0.202148438}},
{{0.193359375,0.087890625},{0.494140625,0.224609375}},
{{0.184570312,0.0966796875},{0.471679688,0.247070312}},
{{0.17578125,0.10546875},{0.44921875,0.26953125}},
{{0.166992188,0.114257812},{0.426757812,0.291992188}},
{{0.158203125,0.123046875},{0.404296875,0.314453125}},
{{0.149414062,0.131835938},{0.381835938,0.336914062}},
{{0.140625,0.140625},{0.359375,0.359375}},
{{0.131835938,0.149414062},{0.336914062,0.381835938}},
{{0.123046875,0.158203125},{0.314453125,0.404296875}},
{{0.114257812,0.166992188},{0.291992188,0.426757812}},
{{0.10546875,0.17578125},{0.26953125,0.44921875}},
{{0.0966796875,0.184570312},{0.247070312,0.471679688}},
{{0.087890625,0.193359375},{0.224609375,0.494140625}},
{{0.0791015625,0.202148438},{0.202148438,0.516601562}},
{{0.0703125,0.2109375},{0.1796875,0.5390625}},
{{0.0615234375,0.219726562},{0.157226562,0.561523438}},
{{0.052734375,0.228515625},{0.134765625,0.583984375}},
{{0.0439453125,0.237304688},{0.112304688,0.606445312}},
{{0.03515625,0.24609375},{0.08984375,0.62890625}},
{{0.0263671875,0.254882812},{0.0673828125,0.651367188}},
{{0.017578125,0.263671875},{0.044921875,0.673828125}},
{{0.0087890625,0.272460938},{0.0224609375,0.696289062}},
{{0.25,0},{0.75,0}},
{{0.2421875,0.0078125},{0.7265625,0.0234375}},
{{0.234375,0.015625},{0.703125,0.046875}},
{{0.2265625,0.0234375},{0.6796875,0.0703125}},
{{0.21875,0.03125},{0.65625,0.09375}},
{{0.2109375,0.0390625},{0.6328125,0.1171875}},
{{0.203125,0.046875},{0.609375,0.140625}},
{{0.1953125,0.0546875},{0.5859375,0.1640625}},
{{0.1875,0.0625},{0.5625,0.1875}},
{{0.1796875,0.0703125},{0.5390625,0.2109375}},
{{0.171875,0.078125},{0.515625,0.234375}},
{{0.1640625,0.0859375},{0.4921875,0.2578125}},
{{0.15625,0.09375},{0.46875,0.28125}},
{{0.1484375,0.1015625},{0.4453125,0.3046875}},
{{0.140625,0.109375},{0.421875,0.328125}},
{{0.1328125,0.1171875},{0.3984375,0.3515625}},
{{0.125,0.125},{0.375,0.375}},
{{0.1171875,0.1328125},{0.3515625,0.3984375}},
{{0.109375,0.140625},{0.328125,0.421875}},
{{0.1015625,0.1484375},{0.3046875,0.4453125}},
{{0.09375,0.15625},{0.28125,0.46875}},
{{0.0859375,0.1640625},{0.2578125,0.4921875}},
{{0.078125,0.171875},{0.234375,0.515625}},
{{0.0703125,0.1796875},{0.2109375,0.5390625}},
{{0.0625,0.1875},{0.1875,0.5625}},
{{0.0546875,0.1953125},{0.1640625,0.5859375}},
{{0.046875,0.203125},{0.140625,0.609375}},
{{0.0390625,0.2109375},{0.1171875,0.6328125}},
{{0.03125,0.21875},{0.09375,0.65625}},
{{0.0234375,0.2265625},{0.0703125,0.6796875}},
{{0.015625,0.234375},{0.046875,0.703125}},
{{0.0078125,0.2421875},{0.0234375,0.7265625}},
{{0.21875,0},{0.78125,0}},
{{0.211914062,0.0068359375},{0.756835938,0.0244140625}},
{{0.205078125,0.013671875},{0.732421875,0.048828125}},
{{0.198242188,0.0205078125},{0.708007812,0.0732421875}},
{{0.19140625,0.02734375},{0.68359375,0.09765625}},
{{0.184570312,0.0341796875},{0.659179688,0.122070312}},
{{0.177734375,0.041015625},{0.634765625,0.146484375}},
{{0.170898438,0.0478515625},{0.610351562,0.170898438}},
{{0.1640625,0.0546875},{0.5859375,0.1953125}},
{{0.157226562,0.0615234375},{0.561523438,0.219726562}},
{{0.150390625,0.068359375},{0.537109375,0.244140625}},
{{0.143554688,0.0751953125},{0.512695312,0.268554688}},
{{0.13671875,0.08203125},{0.48828125,0.29296875}},
{{0.129882812,0.0888671875},{0.463867188,0.317382812}},
{{0.123046875,0.095703125},{0.439453125,0.341796875}},
{{0.116210938,0.102539062},{0.415039062,0.366210938}},
{{0.109375,0.109375},{0.390625,0.390625}},
{{0.102539062,0.116210938},{0.366210938,0.415039062}},
{{0.095703125,0.123046875},{0.341796875,0.439453125}},
{{0.0888671875,0.129882812},{0.317382812,0.463867188}},
{{0.08203125,0.13671875},{0.29296875,0.48828125}},
{{0.0751953125,0.143554688},{0.268554688,0.512695312}},
{{0.068359375,0.150390625},{0.244140625,0.537109375}},
{{0.0615234375,0.157226562},{0.219726562,0.561523438}},
{{0.0546875,0.1640625},{0.1953125,0.5859375}},
{{0.0478515625,0.170898438},{0.170898438,0.610351562}},
{{0.041015625,0.177734375},{0.146484375,0.634765625}},
{{0.0341796875,0.184570312},{0.122070312,0.659179688}},
{{0.02734375,0.19140625},{0.09765625,0.68359375}},
{{0.0205078125,0.198242188},{0.0732421875,0.708007812}},
{{0.013671875,0.205078125},{0.048828125,0.732421875}},
{{0.0068359375,0.211914062},{0.0244140625,0.756835938}},
{{0.1875,0},{0.8125,0}},
{{0.181640625,0.005859375},{0.787109375,0.025390625}},
{{0.17578125,0.01171875},{0.76171875,0.05078125}},
{{0.169921875,0.017578125},{0.736328125,0.076171875}},
{{0.1640625,0.0234375},{0.7109375,0.1015625}},
{{0.158203125,0.029296875},{0.685546875,0.126953125}},
{{0.15234375,0.03515625},{0.66015625,0.15234375}},
{{0.146484375,0.041015625},{0.634765625,0.177734375}},
{{0.140625,0.046875},{0.609375,0.203125}},
{{0.134765625,0.052734375},{0.583984375,0.228515625}},
{{0.12890625,0.05859375},{0.55859375,0.25390625}},
{{0.123046875,0.064453125},{0.533203125,0.279296875}},
{{0.1171875,0.0703125},{0.5078125,0.3046875}},
{{0.111328125,0.076171875},{0.482421875,0.330078125}},
{{0.10546875,0.08203125},{0.45703125,0.35546875}},
{{0.099609375,0.087890625},{0.431640625,0.380859375}},
{{0.09375,0.09375},{0.40625,0.40625}},
{{0.087890625,0.099609375},{0.380859375,0.431640625}},
{{0.08203125,0.10546875},{0.35546875,0.45703125}},
{{0.076171875,0.111328125},{0.330078125,0.482421875}},
{{0.0703125,0.1171875},{0.3046875,0.5078125}},
{{0.064453125,0.123046875},{0.279296875,0.533203125}},
{{0.05859375,0.12890625},{0.25390625,0.55859375}},
{{0.052734375,0.134765625},{0.228515625,0.583984375}},
{{0.046875,0.140625},{0.203125,0.609375}},
{{0.041015625,0.146484375},{0.177734375,0.634765625}},
{{0.03515625,0.15234375},{0.15234375,0.66015625}},
{{0.029296875,0.158203125},{0.126953125,0.685546875}},
{{0.0234375,0.1640625},{0.1015625,0.7109375}},
{{0.017578125,0.169921875},{0.076171875,0.736328125}},
{{0.01171875,0.17578125},{0.05078125,0.76171875}},
{{0.005859375,0.181640625},{0.025390625,0.787109375}},
{{0.15625,0},{0.84375,0}},
{{0.151367188,0.0048828125},{0.817382812,0.0263671875}},
{{0.146484375,0.009765625},{0.791015625,0.052734375}},
{{0.141601562,0.0146484375},{0.764648438,0.0791015625}},
{{0.13671875,0.01953125},{0.73828125,0.10546875}},
{{0.131835938,0.0244140625},{0.711914062,0.131835938}},
{{0.126953125,0.029296875},{0.685546875,0.158203125}},
{{0.122070312,0.0341796875},{0.659179688,0.184570312}},
{{0.1171875,0.0390625},{0.6328125,0.2109375}},
{{0.112304688,0.0439453125},{0.606445312,0.237304688}},
{{0.107421875,0.048828125},{0.580078125,0.263671875}},
{{0.102539062,0.0537109375},{0.553710938,0.290039062}},
{{0.09765625,0.05859375},{0.52734375,0.31640625}},
{{0.0927734375,0.0634765625},{0.500976562,0.342773438}},
{{0.087890625,0.068359375},{0.474609375,0.369140625}},
{{0.0830078125,0.0732421875},{0.448242188,0.395507812}},
{{0.078125,0.078125},{0.421875,0.421875}},
{{0.0732421875,0.0830078125},{0.395507812,0.448242188}},
{{0.068359375,0.087890625},{0.369140625,0.474609375}},
{{0.0634765625,0.0927734375},{0.342773438,0.500976562}},
{{0.05859375,0.09765625},{0.31640625,0.52734375}},
{{0.0537109375,0.102539062},{0.290039062,0.553710938}},
{{0.048828125,0.107421875},{0.263671875,0.580078125}},
{{0.0439453125,0.112304688},{0.237304688,0.606445312}},
{{0.0390625,0.1171875},{0.2109375,0.6328125}},
{{0.0341796875,0.122070312},{0.184570312,0.659179688}},
{{0.029296875,0.126953125},{0.158203125,0.685546875}},
{{0.0244140625,0.131835938},{0.131835938,0.711914062}},
{{0.01953125,0.13671875},{0.10546875,0.73828125}},
{{0.0146484375,0.141601562},{0.0791015625,0.764648438}},
{{0.009765625,0.146484375},{0.052734375,0.791015625}},
{{0.0048828125,0.151367188},{0.0263671875,0.817382812}},
{{0.125,0},{0.875,0}},
{{0.12109375,0.00390625},{0.84765625,0.02734375}},
{{0.1171875,0.0078125},{0.8203125,0.0546875}},
{{0.11328125,0.01171875},{0.79296875,0.08203125}},
{{0.109375,0.015625},{0.765625,0.109375}},
{{0.10546875,0.01953125},{0.73828125,0.13671875}},
{{0.1015625,0.0234375},{0.7109375,0.1640625}},
{{0.09765625,0.02734375},{0.68359375,0.19140625}},
{{0.09375,0.03125},{0.65625,0.21875}},
{{0.08984375,0.03515625},{0.62890625,0.24609375}},
{{0.0859375,0.0390625},{0.6015625,0.2734375}},
{{0.08203125,0.04296875},{0.57421875,0.30078125}},
{{0.078125,0.046875},{0.546875,0.328125}},
{{0.07421875,0.05078125},{0.51953125,0.35546875}},
{{0.0703125,0.0546875},{0.4921875,0.3828125}},
{{0.06640625,0.05859375},{0.46484375,0.41015625}},
{{0.0625,0.0625},{0.4375,0.4375}},
{{0.05859375,0.06640625},{0.41015625,0.46484375}},
{{0.0546875,0.0703125},{0.3828125,0.4921875}},
{{0.05078125,0.07421875},{0.35546875,0.51953125}},
{{0.046875,0.078125},{0.328125,0.546875}},
{{0.04296875,0.08203125},{0.30078125,0.57421875}},
{{0.0390625,0.0859375},{0.2734375,0.6015625}},
{{0.03515625,0.08984375},{0.24609375,0.62890625}},
{{0.03125,0.09375},{0.21875,0.65625}},
{{0.02734375,0.09765625},{0.19140625,0.68359375}},
{{0.0234375,0.1015625},{0.1640625,0.7109375}},
{{0.01953125,0.10546875},{0.13671875,0.73828125}},
{{0.015625,0.109375},{0.109375,0.765625}},
{{0.01171875,0.11328125},{0.08203125,0.79296875}},
{{0.0078125,0.1171875},{0.0546875,0.8203125}},
{{0.00390625,0.12109375},{0.02734375,0.84765625}},
{{0.09375,0},{0.90625,0}},
{{0.0908203125,0.0029296875},{0.877929688,0.0283203125}},
{{0.087890625,0.005859375},{0.849609375,0.056640625}},
{{0.0849609375,0.0087890625},{0.821289062,0.0849609375}},
{{0.08203125,0.01171875},{0.79296875,0.11328125}},
{{0.0791015625,0.0146484375},{0.764648438,0.141601562}},
{{0.076171875,0.017578125},{0.736328125,0.169921875}},
{{0.0732421875,0.0205078125},{0.708007812,0.198242188}},
{{0.0703125,0.0234375},{0.6796875,0.2265625}},
{{0.0673828125,0.0263671875},{0.651367188,0.254882812}},
{{0.064453125,0.029296875},{0.623046875,0.283203125}},
{{0.0615234375,0.0322265625},{0.594726562,0.311523438}},
{{0.05859375,0.03515625},{0.56640625,0.33984375}},
{{0.0556640625,0.0380859375},{0.538085938,0.368164062}},
{{0.052734375,0.041015625},{0.509765625,0.396484375}},
{{0.0498046875,0.0439453125},{0.481445312,0.424804688}},
{{0.046875,0.046875},{0.453125,0.453125}},
{{0.0439453125,0.0498046875},{0.424804688,0.481445312}},
{{0.041015625,0.052734375},{0.396484375,0.509765625}},
{{0.0380859375,0.0556640625},{0.368164062,0.538085938}},
{{0.03515625,0.05859375},{0.33984375,0.56640625}},
{{0.0322265625,0.0615234375},{0.311523438,0.594726562}},
{{0.029296875,0.064453125},{0.283203125,0.623046875}},
{{0.0263671875,0.0673828125},{0.254882812,0.651367188}},
{{0.0234375,0.0703125},{0.2265625,0.6796875}},
{{0.0205078125,0.0732421875},{0.198242188,0.708007812}},
{{0.017578125,0.076171875},{0.169921875,0.736328125}},
{{0.0146484375,0.0791015625},{0.141601562,0.764648438}},
{{0.01171875,0.08203125},{0.11328125,0.79296875}},
{{0.0087890625,0.0849609375},{0.0849609375,0.821289062}},
{{0.005859375,0.087890625},{0.056640625,0.849609375}},
{{0.0029296875,0.0908203125},{0.0283203125,0.877929688}},
{{0.0625,0},{0.9375,0}},
{{0.060546875,0.001953125},{0.908203125,0.029296875}},
{{0.05859375,0.00390625},{0.87890625,0.05859375}},
{{0.056640625,0.005859375},{0.849609375,0.087890625}},
{{0.0546875,0.0078125},{0.8203125,0.1171875}},
{{0.052734375,0.009765625},{0.791015625,0.146484375}},
{{0.05078125,0.01171875},{0.76171875,0.17578125}},
{{0.048828125,0.013671875},{0.732421875,0.205078125}},
{{0.046875,0.015625},{0.703125,0.234375}},
{{0.044921875,0.017578125},{0.673828125,0.263671875}},
{{0.04296875,0.01953125},{0.64453125,0.29296875}},
{{0.041015625,0.021484375},{0.615234375,0.322265625}},
{{0.0390625,0.0234375},{0.5859375,0.3515625}},
{{0.037109375,0.025390625},{0.556640625,0.380859375}},
{{0.03515625,0.02734375},{0.52734375,0.41015625}},
{{0.033203125,0.029296875},{0.498046875,0.439453125}},
{{0.03125,0.03125},{0.46875,0.46875}},
{{0.029296875,0.033203125},{0.439453125,0.498046875}},
{{0.02734375,0.03515625},{0.41015625,0.52734375}},
{{0.025390625,0.037109375},{0.380859375,0.556640625}},
{{0.0234375,0.0390625},{0.3515625,0.5859375}},
{{0.021484375,0.041015625},{0.322265625,0.615234375}},
{{0.01953125,0.04296875},{0.29296875,0.64453125}},
{{0.017578125,0.044921875},{0.263671875,0.673828125}},
{{0.015625,0.046875},{0.234375,0.703125}},
{{0.013671875,0.048828125},{0.205078125,0.732421875}},
{{0.01171875,0.05078125},{0.17578125,0.76171875}},
{{0.009765625,0.052734375},{0.146484375,0.791015625}},
{{0.0078125,0.0546875},{0.1171875,0.8203125}},
{{0.005859375,0.056640625},{0.087890625,0.849609375}},
{{0.00390625,0.05859375},{0.05859375,0.87890625}},
{{0.001953125,0.060546875},{0.029296875,0.908203125}},
{{0.03125,0},{0.96875,0}},
{{0.0302734375,0.0009765625},{0.938476562,0.0302734375}},
{{0.029296875,0.001953125},{0.908203125,0.060546875}},
{{0.0283203125,0.0029296875},{0.877929688,0.0908203125}},
{{0.02734375,0.00390625},{0.84765625,0.12109375}},
{{0.0263671875,0.0048828125},{0.817382812,0.151367188}},
{{0.025390625,0.005859375},{0.787109375,0.181640625}},
{{0.0244140625,0.0068359375},{0.756835938,0.211914062}},
{{0.0234375,0.0078125},{0.7265625,0.2421875}},
{{0.0224609375,0.0087890625},{0.696289062,0.272460938}},
{{0.021484375,0.009765625},{0.666015625,0.302734375}},
{{0.0205078125,0.0107421875},{0.635742188,0.333007812}},
{{0.01953125,0.01171875},{0.60546875,0.36328125}},
{{0.0185546875,0.0126953125},{0.575195312,0.393554688}},
{{0.017578125,0.013671875},{0.544921875,0.423828125}},
{{0.0166015625,0.0146484375},{0.514648438,0.454101562}},
{{0.015625,0.015625},{0.484375,0.484375}},
{{0.0146484375,0.0166015625},{0.454101562,0.514648438}},
{{0.013671875,0.017578125},{0.423828125,0.544921875}},
{{0.0126953125,0.0185546875},{0.393554688,0.575195312}},
{{0.01171875,0.01953125},{0.36328125,0.60546875}},
{{0.0107421875,0.0205078125},{0.333007812,0.635742188}},
{{0.009765625,0.021484375},{0.302734375,0.666015625}},
{{0.0087890625,0.0224609375},{0.272460938,0.696289062}},
{{0.0078125,0.0234375},{0.2421875,0.7265625}},
{{0.0068359375,0.0244140625},{0.211914062,0.756835938}},
{{0.005859375,0.025390625},{0.181640625,0.787109375}},
{{0.0048828125,0.0263671875},{0.151367188,0.817382812}},
{{0.00390625,0.02734375},{0.12109375,0.84765625}},
{{0.0029296875,0.0283203125},{0.0908203125,0.877929688}},
{{0.001953125,0.029296875},{0.060546875,0.908203125}},
{{0.0009765625,0.0302734375},{0.0302734375,0.938476562}}
};
#include "common.hpp"
#include "util.hpp"
#include "vec_math.hpp"
namespace arctern {
namespace cuda {
namespace device {

__device__  float3 NormalizeType1(const uchar3 &pixel) {
  float3 temp;
  temp.x = ((float) pixel.x);
  temp.y = ((float) pixel.y);
  temp.z = ((float) pixel.z);
  return temp;
}
__device__ __host__ short saturate_cast_short(int v)
{
  return (short)((unsigned)(v - SHRT_MIN) <= (unsigned)USHRT_MAX ? v : v > 0 ? SHRT_MAX : SHRT_MIN);
}

template<typename ST, typename WT>
  __global__ void affine_k(const PtrStepSz<ST> src, PtrStepSz<WT> dst,  double *transform) {
  const int dst_x = blockDim.x * blockIdx.x + threadIdx.x;
  const int dst_y = blockDim.y * blockIdx.y + threadIdx.y;

  if (dst_x < dst.cols && dst_y < dst.rows) {
    WT result;
    int X0 = __double2int_rn((transform[1] * dst_y + transform[2]) * 1024) + 16;
    int Y0 = __double2int_rn((transform[4] * dst_y + transform[5]) * 1024) + 16;

    int X = (X0 + __double2int_rn(transform[0] * dst_x * 1024)) >> 5;
    int Y = (Y0 + __double2int_rn(transform[3] * dst_x * 1024)) >> 5;

    short XY_0 = saturate_cast_short(X >> 5);
    short XY_1 = saturate_cast_short(Y >> 5);
    short fxy = (short) ((Y & 31) * 32 + (X & 31));
    unsigned short FXY = (unsigned short) (fxy & 1023);

    int src_imgWidth = src.cols - 1;
    int src_imgHeight = src.rows - 1;

    if ((unsigned) XY_0 < src_imgWidth && (unsigned) XY_1 < src_imgHeight) {
      int sx = XY_0, sy = XY_1;
      const float *w = BilinearTab_f[0][0] + FXY * 4;
      /// uchar3
      ST *pixel = (ST *) ((char *) (src.ptr()) + sy * src.step + sx * sizeof(ST));
      ST *pixel_n = (ST *) ((char *) (src.ptr()) + (sy + 1) * src.step + sx * sizeof(ST));
      WT pixel_f1 = NormalizeType1(*pixel);
      WT pixel_f2 = NormalizeType1(*(pixel + 1));
      WT pixel_f3 = NormalizeType1(*pixel_n);
      WT pixel_f4 = NormalizeType1(*(pixel_n + 1));

      result.x = pixel_f1.x * w[0] + pixel_f2.x * w[1] + pixel_f3.x * w[2] + pixel_f4.x * w[3];
      result.y = pixel_f1.y * w[0] + pixel_f2.y * w[1] + pixel_f3.y * w[2] + pixel_f4.y * w[3];
      result.z = pixel_f1.z * w[0] + pixel_f2.z * w[1] + pixel_f3.z * w[2] + pixel_f4.z * w[3];
    } else {
      int sx = XY_0, sy = XY_1;
      if (sx >= src_imgWidth || sx + 1 < 0 || sy >= src_imgHeight || sy + 1 < 0) {
        result.x = 0;
        result.y = 0;
        result.z = 0;
      } else {
        int sx0, sx1, sy0, sy1;
        const float *w = BilinearTab_f[0][0] + FXY * 4;
        sx0 = (unsigned) sx < (unsigned) src.cols ? sx : -1;
        sx1 = (unsigned) (sx + 1) < (unsigned) src.cols ? sx + 1 : -1;
        sy0 = (unsigned) sy < (unsigned) src.rows ? sy : -1;
        sy1 = (unsigned) (sy + 1) < (unsigned) src.rows ? sy + 1 : -1;
        WT cval;
        cval.x = 0;
        cval.y = 0;
        cval.z = 0;
        WT pixel_f1 = sx0 >= 0 && sy0 >= 0 ?
                      NormalizeType1(*(ST *) ((char *) (src.ptr()) + sy0 * src.step + sx0 * sizeof(ST))) : cval;
        WT pixel_f2 = sx1 >= 0 && sy0 >= 0 ?
                      NormalizeType1(*(ST *) ((char *) (src.ptr()) + sy0 * src.step + sx1 * sizeof(ST))) : cval;
        WT pixel_f3 = sx0 >= 0 && sy1 >= 0 ?
                      NormalizeType1(*(ST *) ((char *) (src.ptr()) + sy1 * src.step + sx0 * sizeof(ST))) : cval;
        WT pixel_f4 = sx1 >= 0 && sy1 >= 0 ?
                      NormalizeType1(*(ST *) ((char *) (src.ptr()) + sy1 * src.step + sx1 * sizeof(ST))) : cval;

        result.x = pixel_f1.x * w[0] + pixel_f2.x * w[1] + pixel_f3.x * w[2] + pixel_f4.x * w[3];
        result.y = pixel_f1.y * w[0] + pixel_f2.y * w[1] + pixel_f3.y * w[2] + pixel_f4.y * w[3];
        result.z = pixel_f1.z * w[0] + pixel_f2.z * w[1] + pixel_f3.z * w[2] + pixel_f4.z * w[3];
      }
    }
    dst(dst_y, dst_x) = result;
  }
}

template<typename ST, typename WT>
void affine(const PtrStepSz<ST> &src, PtrStepSz<WT> dst,  double transform[2][3],cudaStream_t *m_pStream) {
  void *devicePtr = nullptr;
  cudaSafeCall( cudaMalloc(&devicePtr,6*sizeof(double )));

  cudaSafeCall( cudaMemcpyAsync(devicePtr,transform,6*sizeof(double ),cudaMemcpyHostToDevice,*m_pStream));

  const dim3 block(64, 16);
  const dim3 grid(divUp(dst.cols, block.x), divUp(dst.rows, block.y));

  affine_k<ST, WT><<<grid, block, 0, *m_pStream>>>(src, dst, (double*)devicePtr);

  cudaSafeCall(cudaGetLastError());

  //cudaSafeCall(cudaStreamSynchronize(m_pStream));

  cudaSafeCall(cudaFree(devicePtr));
}

template<typename ST, typename WT>
void affine(const PtrStepSzb &src, PtrStepSzb &dst,  double transform[2][3],cudaStream_t *m_pStream) {
  affine<ST, WT>(static_cast<PtrStepSz<ST> >(src), static_cast<PtrStepSz<WT> > (dst), transform,m_pStream);
}

template void affine<uchar3, float3>(const PtrStepSzb &src, PtrStepSzb &dst,  double transform[2][3],cudaStream_t *m_pStream);
}}}
